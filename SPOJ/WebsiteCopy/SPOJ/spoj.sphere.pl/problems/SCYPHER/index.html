<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from spoj.sphere.pl/problems/SCYPHER/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:48:46 GMT -->
<head>
<title>Sphere Online Judge (SPOJ)  - Problem SCYPHER</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<META NAME="Keywords" CONTENT="spoj, online, judge, problem, set, problemset, archive, ACM, Polish, Poland, contest, contester, task, tasks, ADA, Java, Pascal, C, C++, Whitespace, sphere, interest, group, python, ruby, icon, o'caml, caml, ocaml, perl, haskell, bf, brain, clips, prolog, fortran, asm, assembler, asembler, functional, esoteric, programming, languages">

<link href="https://spoj.sphere.pl/gfx/favicon" rel="shortcut icon" type="image/x-icon">

<link href="../../themes/skin3.css" rel="stylesheet" type="text/css" id="theme">
<style type="text/css">
<!--
.maintable {width: 755;} 
-->
</style>
<script type="text/javascript" language="javascript">
<!--
function UnCryptMailto(s) {
	var n=0;
	var r="";
	for(var i=0;i<s.length;i++) {		
		n=s.charCodeAt(i); 
		if (n>=8364) {n = 128;}
		r += String.fromCharCode(n+(2));	
	}
	return r;
}
function linkTo_UnCryptMailto(s)	{
	location.href=UnCryptMailto(s);
}
// -->
</script>

</head>
<body>
<center>
<table cellpadding="10" cellspacing="0" class="maintable" id="maintable">
<tr>
    <td colspan="2" class="header">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
		<td class="headerleft"/>
		<td class="headercenter"><h1>Sphere Online Judge</h1></td>
		<td class="headerright"/>
	</tr>
	</table>
    </td>
</tr>
<tr><td class="menu" width="92" valign="top">
<form name="login"  action="http://spoj.sphere.pl/problems/SCYPHER/" method="post" 
	onsubmit="if(document.login.ssl.checked) document.login.action='https://spoj.sphere.pl/problems/SCYPHER/'" style="margin-bottom: 18px"> 
User: <input name="login_user" type="text" style="width: 85px;" class="form"><BR>
Password: <input name="password" type="password" style="width: 85px;" class="form"><BR>
<script language="javascript" type="text/javascript">
<!--
document.write('<input type="checkbox" name="ssl" id="ssl" checked>secure<br>');
//-->
</script>
<input name="submit" type="submit" value="Log In" class="button" style="width: 85px;">
</form><div class="menucmd"><a href="https://spoj.sphere.pl/register">register</a><br><br><a href="https://spoj.sphere.pl/status">status</a><br><a href="https://spoj.sphere.pl/submit">submit</a><br><a href="../classical/sort=0,start=250.html">problems</a><br><br><a href="https://spoj.sphere.pl/">news</a><br><a href="https://spoj.sphere.pl/contests">contests</a><br><a href="https://spoj.sphere.pl/info">info</a><br><a href="https://spoj.sphere.pl/ranks/">ranks</a><br><br><a href="https://spoj.sphere.pl/forum">forum</a><br><a href="https://spoj.sphere.pl/help">help</a><br><a href="https://spoj.sphere.pl/links">links</a><br><hr></div>Server time:<br>2006-01-10<br>05:47:21<a href="../classical/sort=0,start=250.html"></a><br><br>
<form method="get" action="https://spoj.sphere.pl/search/" class="form" style="width:90px">
<input type="text" name="query" style="width:85px" maxlength=255 value="" class="form"><br>
<input type="submit" value="Search" style="width:85px" class="form" title="Search site"><br>
&nbsp;<a href="https://spoj.sphere.pl/search/problems=on,users=on,contests=on" title="More search options"><small>advanced...</small></a>
</form></td><td class="content" width="99%"><table class="problems" width="100%">
<tr class="navigation">
<td><a href="https://spoj.sphere.pl/submit/SCYPHER/">Submit</a></td>
<td><a href="https://spoj.sphere.pl/status/SCYPHER/">All submissions</a></td>
<td><a href="https://spoj.sphere.pl/ranks/SCYPHER/">Best solutions</a></td>
<td><a href="https://spoj.sphere.pl/problems/SCYPHER.ps">PS</a></td>
<td><a href="https://spoj.sphere.pl/problems/SCYPHER.pdf">PDF</a></td>
<td><a href="../classical/sort=0,start=250.html">Back to list</a></td>
</tr>
</table>

<div class="prob">

<h2>SPOJ Problem Set </h2>
<h1>44. Substitution Cipher</h1>
<h2>Problem code: SCYPHER</h2>
<p align="justify">
<P>Antique Comedians of Malidinesia would like to play a new discovered
comedy of Aristofanes. Putting it on a stage should be a big surprise for
the audience so all the preparations must be kept absolutely secret.
The ACM director suspects one of his competitors of reading his
correspondece. To prevent other companies from revealing his secret, he
decided to use a substitution cipher in all the letters mentioning the
new play.

<P>Substitution cipher is defined by a substitution table assigning each
character of the substitution alphabet another character of the same alphabet.
The assignment is a bijection (to each character exactly
one character is assigned -- not neccessary different).
The director is afraid of disclosing the substitution table and
therefore he changes it frequently. After each change he chooses a few
words from a dictionary by random, encrypts them and sends them together with
an encrypted message. The plain (i.e. non-encrypted) words
are sent by a secure channel, not by mail. The recipient of the message
can then compare plain and encrypted words and create
a new substitution table.

<P>Unfortunately, one of the ACM cipher specialists have found that this
system is sometimes insecure. Some messages can be decrypted by the rival
company even without knowing the plain words. The reason is
that when the director chooses the words from the dictionary and encrypts them, 
he never changes their order (the words in the dictionary are
lexicographically sorted). String <VAR>a<SUB>1</SUB>a<SUB>2</SUB> ...
a<SUB>p</SUB></VAR> is lexicografically smaller than
<VAR>b<SUB>1</SUB>b<SUB>2</SUB> ... b<SUB>q</SUB></VAR> if there exists an
integer <VAR>i</VAR>, <VAR>i &lt;= p, i &lt;= q</VAR>, such that
<VAR>a<SUB>j</SUB>=b<SUB>j</SUB></VAR> for each <VAR>j, 1 &lt;= j &lt;
i</VAR> and <VAR>a<SUB>i</SUB> &lt; b<SUB>i</SUB></VAR>.

<P>The director is interested in which of his messages could be
read by the rival company. You are to write a program to determine that.


<H3>Input</H3>

<P>The input consists of <VAR>N</VAR> cases (equal to about 1000). The first line of the input
contains only positive integer <VAR>N</VAR>. Then follow the cases. 
The first line of each case contains only two positive integers
<VAR>A</VAR>, <VAR>1 &lt;= A &lt;= 26</VAR>, and <VAR>K</VAR>, separated by
space. <VAR>A</VAR> determines the size of the substitution alphabet (the
substitution alphabet consists of the first <VAR>A</VAR> lowercase letters
of the english alphabet (a--z) and <VAR>K</VAR> is the number of encrypted
words. The plain words contain only the letters of the substitution
alphabet. The plain message can contain any symbol, but only the letters of
the substitution alphabet are encrypted. Then follow <VAR>K</VAR> lines,
each containing exactly one encrypted word. At the next line is encrypted
message.


<H3>Output</H3>

<P>For each case, print exactly one line. If it is possible
to decrypt the message uniquely, print the
decrypted message. Otherwise, print the sentence
'<TT>Message cannot be decrypted.</TT>'.


<H3>Example</H3>
<PRE>
Sample input:

2
5 6
cebdbac
cac
ecd
dca
aba
bac
cedab
4 4
cca
cad
aac
bca
bdac

Sample output:

abcde
Message cannot be decrypted.
</PRE>
<b>Warning: large Input/Output data, be careful with certain languages</b>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left>
<tr><td width=130>Added by:</td><td><a href="https://spoj.sphere.pl/search/'Adrian%20Kosowski'">Adrian Kosowski</a></td></tr>
<tr><td>Date:</td><td>2004-06-06</td></tr>
<tr><td>Time limit:</td><td>5s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Resource:</td><td>ACM Central European Programming Contest, Prague 1998</td></tr></table>
</div></td>
</tr>

<tr>
<td colspan="2" class="footer">

<script language="javascript" type="text/javascript">
<!--
function swapSheet(sheet, caller) {
    document.getElementById('theme').href=sheet;
    document.cookie="css_0="+sheet+"; path=/;";
    caller.href="#bottom";
}

function setWidth(w, caller) {
    document.getElementById('maintable').style.width=w;
    document.cookie="res="+w+"; path=/;";
    caller.href="#bottom";
}
//-->

</script>
        <table width="100%">
    <tr>
	<td align="left">
            <a href="http://www.pg.gda.pl/eng.html"><IMG src="https://spoj.sphere.pl/gfx/logo-pg" alt="www.pg.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://www.eti.pg.gda.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-eti" alt="www.eti.pg.gda.pl" border=0 height=36 width=44></a>
	</td>
	<td align="center">
	    page size:
	    <a href="https://spoj.sphere.pl/?res=755"  onClick="setWidth('755', this)">800x600</a>
	    <a href="https://spoj.sphere.pl/?res=980"  onClick="setWidth('980', this)">1024x768</a>
	    <a href="https://spoj.sphere.pl/?res=100%" onClick="setWidth('100%', this)">Full</a>
	    &nbsp;&nbsp;
	    theme:
	    <a href="../../indexb6a4.html?css=/themes/skin1.css" onClick="swapSheet('../../themes/skin1.css', this)">olive</a>
	    <a href="../../index3840.html?css=/themes/skin2.css" onClick="swapSheet('../../themes/skin2.css', this)">banana</a>
	    <a href="../../index80f0.html?css=/themes/skin3.css" onClick="swapSheet('../../themes/skin3.css', this)">plum</a>
	    <br>
	    <a href="http://sphere.pl/?id=66">spoj team at sphere</a> &copy; 2004-05 all rights reserved
	</td>
	<td align="right">
            <a href="http://task.gda.pl/english/"><IMG src="https://spoj.sphere.pl/gfx/logo-task" alt="task.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://sphere.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-sphere" alt="sphere.pl" border=0 height=32></a>
	</td>
    </tr>
    </table>
    </tr></table>
</center>
</body>

<!-- Mirrored from spoj.sphere.pl/problems/SCYPHER/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:48:46 GMT -->
</html>