<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from spoj.sphere.pl/problems/CONNECT/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:53:03 GMT -->
<head>
<title>Sphere Online Judge (SPOJ)  - Problem CONNECT</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<META NAME="Keywords" CONTENT="spoj, online, judge, problem, set, problemset, archive, ACM, Polish, Poland, contest, contester, task, tasks, ADA, Java, Pascal, C, C++, Whitespace, sphere, interest, group, python, ruby, icon, o'caml, caml, ocaml, perl, haskell, bf, brain, clips, prolog, fortran, asm, assembler, asembler, functional, esoteric, programming, languages">

<link href="https://spoj.sphere.pl/gfx/favicon" rel="shortcut icon" type="image/x-icon">

<link href="../../themes/skin3.css" rel="stylesheet" type="text/css" id="theme">
<style type="text/css">
<!--
.maintable {width: 755;} 
-->
</style>
<script type="text/javascript" language="javascript">
<!--
function UnCryptMailto(s) {
	var n=0;
	var r="";
	for(var i=0;i<s.length;i++) {		
		n=s.charCodeAt(i); 
		if (n>=8364) {n = 128;}
		r += String.fromCharCode(n+(2));	
	}
	return r;
}
function linkTo_UnCryptMailto(s)	{
	location.href=UnCryptMailto(s);
}
// -->
</script>

</head>
<body>
<center>
<table cellpadding="10" cellspacing="0" class="maintable" id="maintable">
<tr>
    <td colspan="2" class="header">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
		<td class="headerleft"/>
		<td class="headercenter"><h1>Sphere Online Judge</h1></td>
		<td class="headerright"/>
	</tr>
	</table>
    </td>
</tr>
<tr><td class="menu" width="92" valign="top">
<form name="login"  action="http://spoj.sphere.pl/problems/CONNECT/" method="post" 
	onsubmit="if(document.login.ssl.checked) document.login.action='https://spoj.sphere.pl/problems/CONNECT/'" style="margin-bottom: 18px"> 
User: <input name="login_user" type="text" style="width: 85px;" class="form"><BR>
Password: <input name="password" type="password" style="width: 85px;" class="form"><BR>
<script language="javascript" type="text/javascript">
<!--
document.write('<input type="checkbox" name="ssl" id="ssl" checked>secure<br>');
//-->
</script>
<input name="submit" type="submit" value="Log In" class="button" style="width: 85px;">
</form><div class="menucmd"><a href="https://spoj.sphere.pl/register">register</a><br><br><a href="https://spoj.sphere.pl/status">status</a><br><a href="https://spoj.sphere.pl/submit">submit</a><br><a href="../classical/sort=5,start=0.html">problems</a><br><br><a href="https://spoj.sphere.pl/">news</a><br><a href="https://spoj.sphere.pl/contests">contests</a><br><a href="https://spoj.sphere.pl/info">info</a><br><a href="https://spoj.sphere.pl/ranks/">ranks</a><br><br><a href="https://spoj.sphere.pl/forum">forum</a><br><a href="https://spoj.sphere.pl/help">help</a><br><a href="https://spoj.sphere.pl/links">links</a><br><hr></div>Server time:<br>2006-01-10<br>05:48:26<a href="../classical/sort=5,start=0.html"></a><br><br>
<form method="get" action="https://spoj.sphere.pl/search/" class="form" style="width:90px">
<input type="text" name="query" style="width:85px" maxlength=255 value="" class="form"><br>
<input type="submit" value="Search" style="width:85px" class="form" title="Search site"><br>
&nbsp;<a href="https://spoj.sphere.pl/search/problems=on,users=on,contests=on" title="More search options"><small>advanced...</small></a>
</form></td><td class="content" width="99%"><table class="problems" width="100%">
<tr class="navigation">
<td><a href="https://spoj.sphere.pl/submit/CONNECT/">Submit</a></td>
<td><a href="https://spoj.sphere.pl/status/CONNECT/">All submissions</a></td>
<td><a href="https://spoj.sphere.pl/ranks/CONNECT/">Best solutions</a></td>
<td><a href="https://spoj.sphere.pl/problems/CONNECT.ps">PS</a></td>
<td><a href="https://spoj.sphere.pl/problems/CONNECT.pdf">PDF</a></td>
<td><a href="../classical/sort=5,start=0.html">Back to list</a></td>
</tr>
</table>

<div class="prob">

<h2>SPOJ Problem Set </h2>
<h1>262. Connections</h1>
<h2>Problem code: CONNECT</h2>
<p align="justify">
<p>
Byteotian Ministry of Infrastructure has decided to create a computer program
that helps to find quickly the lengths of routes between arbitrary towns. It
would be small wonder if the inhabitants of Byteotia always wanted to find the
shortest route. However, it happens that they want to know the <i>k</i>-th
shortest route. Moreover, cycles in routes are possible, i.e. routes that have
recurring towns.
</p>
<p>
For example, if there are 4 routes between two towns and their lengths are 2, 4, 4 and 5, then the length of the shortest connection is 2, the second shortest is 4, the third is 4, and the fourth is 5.
</p>

<h3>Task</h3>
<p>
Write a program that for each test case:
<ul>
  <li>Reads a description of Byteotian road network and
    queries concerning lengths of journey routes.
  <li>Computes and writes answers to the queries read.</li>
</ul>
</p>

<h3>Input</h3>
<p>
One integer in the first line, stating the number of test cases, followed by a blank line. There will be not more than 15 tests. 
</p>

<p>
For each test case, at the first line, there are two positive integers <i>n</i> and <i>m</i>, separated by a single space, 1 <= <i>n</i> <= 100, 0 <= <i>m</i>
<= <i>n</i><sup>2</sup>-<i>n</i>. They are the number of towns in Byteotia and the number of roads connecting the towns, respectively. The towns are numbered from 1 to <i>n</i>.
</p>
<p>
In each of <i>m</i> successive lines there are three integers separated by single spaces: <i>a</i>, <i>b</i> and <i>l</i>, <i>a</i> <> <i>b</i>, 1
<= <i>l</i> <= 500. Each triple describes one one-way road of length <i>l</i>
enabling to move from the town <i>a</i> to <i>b</i>. For each two towns there
exist at most one road that enables to move in the given direction.
</p>
<p>
In the following line there is one integer <i>q</i>, 1 <= <i>q</i> <= 10000, denoting the number of queries. In the successive <i>q</i> lines there are queries written, one per line. Each query has a form of three integers separated by single spaces: <i>c</i>, <i>d</i> and <i>k</i>, 1 <= <i>k</i> <= 100. Such a query refers to the length of the <i>k</i>-th shortest route from the town <i>c</i> to the town <i>d</i>.
</p>
<p>
The test cases will be separated by a single blank line. 
</p>

<h3>Output</h3>
<p>
For each test case, your program should write the answers to the queries read, one answer per line. In the i-th line the answer to the i-th query should be written: one integer equal to the length of the route being sought or -1, when such a route does not exist.
</p>
<p>
Each test case should be separated by a single blank line. 
</p>

<h3>Example</h3>

<pre>
<b>Input:</b>
1

5 5
1 2 3
2 3 2
3 2 1
1 3 10
1 4 1
8
1 3 1
1 3 2
1 3 3
1 4 2
2 5 1
2 2 1
2 2 2
1 1 2

<b>Output:</b>
5
8
10
-1
-1
3
6
-1
</pre>


<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left>
<tr><td width=130>Added by:</td><td><a href="https://spoj.sphere.pl/search/'Thanh%20Vy%20Hua%20Le'">Thanh Vy Hua Le</a></td></tr>
<tr><td>Date:</td><td>2004-12-25</td></tr>
<tr><td>Time limit:</td><td>5s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Resource:</td><td>10th Polish Olympiad in Informatics, stage 2</td></tr></table>
</div></td>
</tr>

<tr>
<td colspan="2" class="footer">

<script language="javascript" type="text/javascript">
<!--
function swapSheet(sheet, caller) {
    document.getElementById('theme').href=sheet;
    document.cookie="css_0="+sheet+"; path=/;";
    caller.href="#bottom";
}

function setWidth(w, caller) {
    document.getElementById('maintable').style.width=w;
    document.cookie="res="+w+"; path=/;";
    caller.href="#bottom";
}
//-->

</script>
        <table width="100%">
    <tr>
	<td align="left">
            <a href="http://www.pg.gda.pl/eng.html"><IMG src="https://spoj.sphere.pl/gfx/logo-pg" alt="www.pg.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://www.eti.pg.gda.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-eti" alt="www.eti.pg.gda.pl" border=0 height=36 width=44></a>
	</td>
	<td align="center">
	    page size:
	    <a href="https://spoj.sphere.pl/?res=755"  onClick="setWidth('755', this)">800x600</a>
	    <a href="https://spoj.sphere.pl/?res=980"  onClick="setWidth('980', this)">1024x768</a>
	    <a href="https://spoj.sphere.pl/?res=100%" onClick="setWidth('100%', this)">Full</a>
	    &nbsp;&nbsp;
	    theme:
	    <a href="../../indexb6a4.html?css=/themes/skin1.css" onClick="swapSheet('../../themes/skin1.css', this)">olive</a>
	    <a href="../../index3840.html?css=/themes/skin2.css" onClick="swapSheet('../../themes/skin2.css', this)">banana</a>
	    <a href="../../index80f0.html?css=/themes/skin3.css" onClick="swapSheet('../../themes/skin3.css', this)">plum</a>
	    <br>
	    <a href="http://sphere.pl/?id=66">spoj team at sphere</a> &copy; 2004-05 all rights reserved
	</td>
	<td align="right">
            <a href="http://task.gda.pl/english/"><IMG src="https://spoj.sphere.pl/gfx/logo-task" alt="task.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://sphere.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-sphere" alt="sphere.pl" border=0 height=32></a>
	</td>
    </tr>
    </table>
    </tr></table>
</center>
</body>

<!-- Mirrored from spoj.sphere.pl/problems/CONNECT/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:53:03 GMT -->
</html>