<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from spoj.sphere.pl/problems/HAN01/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 05:02:06 GMT -->
<head>
<title>Sphere Online Judge (SPOJ)  - Problem HAN01</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<META NAME="Keywords" CONTENT="spoj, online, judge, problem, set, problemset, archive, ACM, Polish, Poland, contest, contester, task, tasks, ADA, Java, Pascal, C, C++, Whitespace, sphere, interest, group, python, ruby, icon, o'caml, caml, ocaml, perl, haskell, bf, brain, clips, prolog, fortran, asm, assembler, asembler, functional, esoteric, programming, languages">

<link href="https://spoj.sphere.pl/gfx/favicon" rel="shortcut icon" type="image/x-icon">

<link href="../../themes/skin3.css" rel="stylesheet" type="text/css" id="theme">
<style type="text/css">
<!--
.maintable {width: 755;} 
-->
</style>
<script type="text/javascript" language="javascript">
<!--
function UnCryptMailto(s) {
	var n=0;
	var r="";
	for(var i=0;i<s.length;i++) {		
		n=s.charCodeAt(i); 
		if (n>=8364) {n = 128;}
		r += String.fromCharCode(n+(2));	
	}
	return r;
}
function linkTo_UnCryptMailto(s)	{
	location.href=UnCryptMailto(s);
}
// -->
</script>

</head>
<body>
<center>
<table cellpadding="10" cellspacing="0" class="maintable" id="maintable">
<tr>
    <td colspan="2" class="header">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
		<td class="headerleft"/>
		<td class="headercenter"><h1>Sphere Online Judge</h1></td>
		<td class="headerright"/>
	</tr>
	</table>
    </td>
</tr>
<tr><td class="menu" width="92" valign="top">
<form name="login"  action="http://spoj.sphere.pl/problems/HAN01/" method="post" 
	onsubmit="if(document.login.ssl.checked) document.login.action='https://spoj.sphere.pl/problems/HAN01/'" style="margin-bottom: 18px"> 
User: <input name="login_user" type="text" style="width: 85px;" class="form"><BR>
Password: <input name="password" type="password" style="width: 85px;" class="form"><BR>
<script language="javascript" type="text/javascript">
<!--
document.write('<input type="checkbox" name="ssl" id="ssl" checked>secure<br>');
//-->
</script>
<input name="submit" type="submit" value="Log In" class="button" style="width: 85px;">
</form><div class="menucmd"><a href="https://spoj.sphere.pl/register">register</a><br><br><a href="https://spoj.sphere.pl/status">status</a><br><a href="https://spoj.sphere.pl/submit">submit</a><br><a href="../classical/sort=5,start=0.html">problems</a><br><br><a href="https://spoj.sphere.pl/">news</a><br><a href="https://spoj.sphere.pl/contests">contests</a><br><a href="https://spoj.sphere.pl/info">info</a><br><a href="https://spoj.sphere.pl/ranks/">ranks</a><br><br><a href="https://spoj.sphere.pl/forum">forum</a><br><a href="https://spoj.sphere.pl/help">help</a><br><a href="https://spoj.sphere.pl/links">links</a><br><hr></div>Server time:<br>2006-01-10<br>05:53:34<a href="../classical/sort=5,start=0.html"></a><br><br>
<form method="get" action="https://spoj.sphere.pl/search/" class="form" style="width:90px">
<input type="text" name="query" style="width:85px" maxlength=255 value="" class="form"><br>
<input type="submit" value="Search" style="width:85px" class="form" title="Search site"><br>
&nbsp;<a href="https://spoj.sphere.pl/search/problems=on,users=on,contests=on" title="More search options"><small>advanced...</small></a>
</form></td><td class="content" width="99%"><table class="problems" width="100%">
<tr class="navigation">
<td><a href="https://spoj.sphere.pl/submit/HAN01/">Submit</a></td>
<td><a href="https://spoj.sphere.pl/status/HAN01/">All submissions</a></td>
<td><a href="https://spoj.sphere.pl/ranks/HAN01/">Best solutions</a></td>
<td><a href="https://spoj.sphere.pl/problems/HAN01.ps">PS</a></td>
<td><a href="https://spoj.sphere.pl/problems/HAN01.pdf">PDF</a></td>
<td><a href="../classical/sort=5,start=0.html">Back to list</a></td>
</tr>
</table>

<div class="prob">

<h2>SPOJ Problem Set </h2>
<h1>351. Ha-noi!</h1>
<h2>Problem code: HAN01</h2>
<p align="justify">
<p>Little Sabrina loves solving puzzles. Last week she got a new puzzle: The "Tower of Hanoi" puzzle. This puzzle is based on an old legend: 
"The temple priests of hanoi have to transfer a tower consisting of 64 fragile disks of gold from one part of the temple to another, one disk at a time. The disks are arranged in order, no two of them the same size, with the largest on the bottom and the smallest on top.
Because of their fragility, a larger disk may never be placed on a smaller one, and there is only one intermediate location where disks can be temporarily placed. It is said that before the priests complete their task the temple will crumble into dust and the world will vanish in a clap of thunder."
Sabrina reconstructed the problem with some coins of different size. She solved the puzzle for three coins in 7 steps, for four coins in 15 steps,... after solving the problem with 7 coins she had the hang of it. Yesterday she started to solve the puzzle with 31 coins and her optimal strategy. After hours of moving coins from one pile to the other she was very tired and went to bed. This was a bad idea! Her little brother Robin discovered the towers of coins and - whoops! - threw it on the floor.
Then he noticed a sheet of paper: "Don't touch this towers! Steps: 16543".
"Oh no!" Robin has to reconstuct to tower because his sister can get very, very angry...
Your task is to help Robin to reconstruct the towers. 
Sabrina started the game with all disks on peg number one and her goal was to move the disks to peg number two. She used her optimal strategy and noted the number of steps she had done.
<h3>Input</h3>
<p>The first line of input contains one integer t: The number of testcases. k lines follow. Each line contains two integers n (2< n< 61) and k (0< k< 2^n). n is the number of disks of the hanoi puzzle and k the number of steps Sabrina had done.
<h3>Output</h3>
<p>Output the reconstructed configuration of the towers after k steps. For each testcase output three lines. One for each tower. Each line consists of the tower identifier (1,2,3) a colon, one space and the disk numbers (n,n-1,...,2,1) which are seperated by a '|'-character. 
<h3>Example</h3>

<pre>
<b>Input:</b>
3
3 6
32 889397450
31 16543
<b>Output:</b>
1: 1
2: 3|2
3:
1: 32|31|28|25|18|17|14|3
2: 30|29|26|13|12|11|10|9|6|5|2
3: 27|24|23|22|21|20|19|16|15|8|7|4|1
1: 31|30|29|28|27|26|25|24|23|22|21|20|19|18|17|16|7|6
2: 15|8|5|4|3|2|1
3: 14|13|12|11|10|9
</pre>


<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left>
<tr><td width=130>Added by:</td><td><a href="https://spoj.sphere.pl/search/'Simon%20Gog'">Simon Gog</a></td></tr>
<tr><td>Date:</td><td>2005-05-03</td></tr>
<tr><td>Time limit:</td><td>2s
</td></tr>
<tr><td>Source limit:</td><td>8082B</td></tr>
<tr><td>Resource:</td><td>Ulm Algorithm Course SoSe 2005</td></tr></table>
</div></td>
</tr>

<tr>
<td colspan="2" class="footer">

<script language="javascript" type="text/javascript">
<!--
function swapSheet(sheet, caller) {
    document.getElementById('theme').href=sheet;
    document.cookie="css_0="+sheet+"; path=/;";
    caller.href="#bottom";
}

function setWidth(w, caller) {
    document.getElementById('maintable').style.width=w;
    document.cookie="res="+w+"; path=/;";
    caller.href="#bottom";
}
//-->

</script>
        <table width="100%">
    <tr>
	<td align="left">
            <a href="http://www.pg.gda.pl/eng.html"><IMG src="https://spoj.sphere.pl/gfx/logo-pg" alt="www.pg.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://www.eti.pg.gda.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-eti" alt="www.eti.pg.gda.pl" border=0 height=36 width=44></a>
	</td>
	<td align="center">
	    page size:
	    <a href="https://spoj.sphere.pl/?res=755"  onClick="setWidth('755', this)">800x600</a>
	    <a href="https://spoj.sphere.pl/?res=980"  onClick="setWidth('980', this)">1024x768</a>
	    <a href="https://spoj.sphere.pl/?res=100%" onClick="setWidth('100%', this)">Full</a>
	    &nbsp;&nbsp;
	    theme:
	    <a href="../../indexb6a4.html?css=/themes/skin1.css" onClick="swapSheet('../../themes/skin1.css', this)">olive</a>
	    <a href="../../index3840.html?css=/themes/skin2.css" onClick="swapSheet('../../themes/skin2.css', this)">banana</a>
	    <a href="../../index80f0.html?css=/themes/skin3.css" onClick="swapSheet('../../themes/skin3.css', this)">plum</a>
	    <br>
	    <a href="http://sphere.pl/?id=66">spoj team at sphere</a> &copy; 2004-05 all rights reserved
	</td>
	<td align="right">
            <a href="http://task.gda.pl/english/"><IMG src="https://spoj.sphere.pl/gfx/logo-task" alt="task.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://sphere.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-sphere" alt="sphere.pl" border=0 height=32></a>
	</td>
    </tr>
    </table>
    </tr></table>
</center>
</body>

<!-- Mirrored from spoj.sphere.pl/problems/HAN01/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 05:02:06 GMT -->
</html>