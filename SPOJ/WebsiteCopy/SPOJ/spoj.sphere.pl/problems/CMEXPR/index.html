<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from spoj.sphere.pl/problems/CMEXPR/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:48:45 GMT -->
<head>
<title>Sphere Online Judge (SPOJ)  - Problem CMEXPR</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<META NAME="Keywords" CONTENT="spoj, online, judge, problem, set, problemset, archive, ACM, Polish, Poland, contest, contester, task, tasks, ADA, Java, Pascal, C, C++, Whitespace, sphere, interest, group, python, ruby, icon, o'caml, caml, ocaml, perl, haskell, bf, brain, clips, prolog, fortran, asm, assembler, asembler, functional, esoteric, programming, languages">

<link href="https://spoj.sphere.pl/gfx/favicon" rel="shortcut icon" type="image/x-icon">

<link href="../../themes/skin3.css" rel="stylesheet" type="text/css" id="theme">
<style type="text/css">
<!--
.maintable {width: 755;} 
-->
</style>
<script type="text/javascript" language="javascript">
<!--
function UnCryptMailto(s) {
	var n=0;
	var r="";
	for(var i=0;i<s.length;i++) {		
		n=s.charCodeAt(i); 
		if (n>=8364) {n = 128;}
		r += String.fromCharCode(n+(2));	
	}
	return r;
}
function linkTo_UnCryptMailto(s)	{
	location.href=UnCryptMailto(s);
}
// -->
</script>

</head>
<body>
<center>
<table cellpadding="10" cellspacing="0" class="maintable" id="maintable">
<tr>
    <td colspan="2" class="header">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
		<td class="headerleft"/>
		<td class="headercenter"><h1>Sphere Online Judge</h1></td>
		<td class="headerright"/>
	</tr>
	</table>
    </td>
</tr>
<tr><td class="menu" width="92" valign="top">
<form name="login"  action="http://spoj.sphere.pl/problems/CMEXPR/" method="post" 
	onsubmit="if(document.login.ssl.checked) document.login.action='https://spoj.sphere.pl/problems/CMEXPR/'" style="margin-bottom: 18px"> 
User: <input name="login_user" type="text" style="width: 85px;" class="form"><BR>
Password: <input name="password" type="password" style="width: 85px;" class="form"><BR>
<script language="javascript" type="text/javascript">
<!--
document.write('<input type="checkbox" name="ssl" id="ssl" checked>secure<br>');
//-->
</script>
<input name="submit" type="submit" value="Log In" class="button" style="width: 85px;">
</form><div class="menucmd"><a href="https://spoj.sphere.pl/register">register</a><br><br><a href="https://spoj.sphere.pl/status">status</a><br><a href="https://spoj.sphere.pl/submit">submit</a><br><a href="../classical/sort=0,start=250.html">problems</a><br><br><a href="https://spoj.sphere.pl/">news</a><br><a href="https://spoj.sphere.pl/contests">contests</a><br><a href="https://spoj.sphere.pl/info">info</a><br><a href="https://spoj.sphere.pl/ranks/">ranks</a><br><br><a href="https://spoj.sphere.pl/forum">forum</a><br><a href="https://spoj.sphere.pl/help">help</a><br><a href="https://spoj.sphere.pl/links">links</a><br><hr></div>Server time:<br>2006-01-10<br>05:47:14<a href="../classical/sort=0,start=250.html"></a><br><br>
<form method="get" action="https://spoj.sphere.pl/search/" class="form" style="width:90px">
<input type="text" name="query" style="width:85px" maxlength=255 value="" class="form"><br>
<input type="submit" value="Search" style="width:85px" class="form" title="Search site"><br>
&nbsp;<a href="https://spoj.sphere.pl/search/problems=on,users=on,contests=on" title="More search options"><small>advanced...</small></a>
</form></td><td class="content" width="99%"><table class="problems" width="100%">
<tr class="navigation">
<td><a href="https://spoj.sphere.pl/submit/CMEXPR/">Submit</a></td>
<td><a href="https://spoj.sphere.pl/status/CMEXPR/">All submissions</a></td>
<td><a href="https://spoj.sphere.pl/ranks/CMEXPR/">Best solutions</a></td>
<td><a href="https://spoj.sphere.pl/problems/CMEXPR.ps">PS</a></td>
<td><a href="https://spoj.sphere.pl/problems/CMEXPR.pdf">PDF</a></td>
<td><a href="../classical/sort=0,start=250.html">Back to list</a></td>
</tr>
</table>

<div class="prob">

<h2>SPOJ Problem Set </h2>
<h1>10. Complicated Expressions</h1>
<h2>Problem code: CMEXPR</h2>
<p align="justify">
<P>
The most important activity of ACM is the GSM network. As the mobile phone
operator, ACM must build its own transmitting stations. It is very important
to compute the exact behaviour of electro-magnetic waves. Unfortunately,
prediction of electro-magnetic fields is a&nbsp;very complex task and the
formulas describing them are very long and hard-to-read. For
example, Maxwell's Equations describing the basic laws of
electrical engineering are really tough.
<p>
ACM has designed its own computer system that can make some field
computations and produce results in the form of mathematic expressions.
Unfortunately, by generating the expression in several steps, there are
always some unneeded parentheses inside the expression. Your task is to take
these partial results and make them "nice" by removing all unnecessary
parentheses.
</p>
<H3>Input</h3>

<P>
There is a&nbsp;single positive integer <VAR>T</var> on the first line of input (equal to about 10000). It stands
for the number of expressions to follow. Each expression consists of a&nbsp;single
line containing only lowercase letters, operators (<TT>+</tt>, <TT>-</tt>, <TT>*</tt>,
<TT>/</tt>) and parentheses (<TT>(</tt> and <TT>)</tt>). The letters are variables
that can have any value, operators and parentheses have their usual meaning.
Multiplication and division have higher priority then subtraction and
addition. All operations with the same priority are computed from left to
right (operators are left-associative). There are no spaces inside the
expressions. No input line contains more than 250 characters.

<P>
<H3>Output</h3>

<P>
Print a&nbsp;single line for every expression. The line must contain the same
expression with unneeded parentheses removed. You must remove as many
parentheses as possible without changing the semantics of the expression.
The semantics of the expression is considered the same if and only if any of
the following conditions hold:
<div align=left>
<UL>
<LI>The ordering of operations remains the same. That means "(<VAR>a</var>+<VAR>b</var>)+<VAR>c</var>" is
  the same as "<VAR>a</var>+<VAR>b</var>+<VAR>c</var>", and "<VAR>a</var>+(<VAR>b</var>/<VAR>c</var>)" is the same as "<VAR>a</var>+<VAR>b</var>/<VAR>c</var>".
<LI>The order of some operations is swapped but the result remains unchanged
  with respect to the addition and multiplication associativity.
  That means "<VAR>a</var>+(<VAR>b</var>+<VAR>c</var>)" and "(<VAR>a</var>+<VAR>b</var>)+<VAR>c</var>" are the same. We can also combine
  addition with subtraction and multiplication with division, if the
  subtraction or division is the second operation. For example, "<VAR>a</var>+(<VAR>b</var>-<VAR>c</var>)"
  is the same as "<VAR>a</var>+<VAR>b</var>-<VAR>c</var>".
</ul>
</div>
<P>
You cannot use any other laws, namely you cannot swap left and right
operands and you cannot replace "<VAR>a</var>-(<VAR>b</var>-<VAR>c</var>)" with "<VAR>a</var>-<VAR>b</var>+<VAR>c</var>".

<h3>Example</h3>
<p>Sample Input:</p>

<PRE>
<tt>8
(a+(b*c))
((a+b)*c)
(a*(b*c))
(a*(b/c)*d)
((a/(b/c))/d)
((x))
(a+b)-(c-d)-(e/f)
(a+b)+(c-d)-(e+f)
</tt></pre>

<p>Sample Output:</p>

<PRE>
<tt>a+b*c
(a+b)*c
a*b*c
a*b/c*d
a/(b/c)/d
x
a+b-(c-d)-e/f
a+b+c-d-(e+f)
</tt></pre>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left>
<tr><td width=130>Added by:</td><td><a href="https://spoj.sphere.pl/search/'Adrian%20Kosowski'">Adrian Kosowski</a></td></tr>
<tr><td>Date:</td><td>2004-05-09</td></tr>
<tr><td>Time limit:</td><td>5s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Resource:</td><td>ACM Central European Programming Contest, Prague 2000</td></tr></table>
</div></td>
</tr>

<tr>
<td colspan="2" class="footer">

<script language="javascript" type="text/javascript">
<!--
function swapSheet(sheet, caller) {
    document.getElementById('theme').href=sheet;
    document.cookie="css_0="+sheet+"; path=/;";
    caller.href="#bottom";
}

function setWidth(w, caller) {
    document.getElementById('maintable').style.width=w;
    document.cookie="res="+w+"; path=/;";
    caller.href="#bottom";
}
//-->

</script>
        <table width="100%">
    <tr>
	<td align="left">
            <a href="http://www.pg.gda.pl/eng.html"><IMG src="https://spoj.sphere.pl/gfx/logo-pg" alt="www.pg.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://www.eti.pg.gda.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-eti" alt="www.eti.pg.gda.pl" border=0 height=36 width=44></a>
	</td>
	<td align="center">
	    page size:
	    <a href="https://spoj.sphere.pl/?res=755"  onClick="setWidth('755', this)">800x600</a>
	    <a href="https://spoj.sphere.pl/?res=980"  onClick="setWidth('980', this)">1024x768</a>
	    <a href="https://spoj.sphere.pl/?res=100%" onClick="setWidth('100%', this)">Full</a>
	    &nbsp;&nbsp;
	    theme:
	    <a href="../../indexb6a4.html?css=/themes/skin1.css" onClick="swapSheet('../../themes/skin1.css', this)">olive</a>
	    <a href="../../index3840.html?css=/themes/skin2.css" onClick="swapSheet('../../themes/skin2.css', this)">banana</a>
	    <a href="../../index80f0.html?css=/themes/skin3.css" onClick="swapSheet('../../themes/skin3.css', this)">plum</a>
	    <br>
	    <a href="http://sphere.pl/?id=66">spoj team at sphere</a> &copy; 2004-05 all rights reserved
	</td>
	<td align="right">
            <a href="http://task.gda.pl/english/"><IMG src="https://spoj.sphere.pl/gfx/logo-task" alt="task.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://sphere.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-sphere" alt="sphere.pl" border=0 height=32></a>
	</td>
    </tr>
    </table>
    </tr></table>
</center>
</body>

<!-- Mirrored from spoj.sphere.pl/problems/CMEXPR/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:48:45 GMT -->
</html>