<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from spoj.sphere.pl/problems/DIRVS/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:48:45 GMT -->
<head>
<title>Sphere Online Judge (SPOJ)  - Problem DIRVS</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<META NAME="Keywords" CONTENT="spoj, online, judge, problem, set, problemset, archive, ACM, Polish, Poland, contest, contester, task, tasks, ADA, Java, Pascal, C, C++, Whitespace, sphere, interest, group, python, ruby, icon, o'caml, caml, ocaml, perl, haskell, bf, brain, clips, prolog, fortran, asm, assembler, asembler, functional, esoteric, programming, languages">

<link href="https://spoj.sphere.pl/gfx/favicon" rel="shortcut icon" type="image/x-icon">

<link href="../../themes/skin3.css" rel="stylesheet" type="text/css" id="theme">
<style type="text/css">
<!--
.maintable {width: 755;} 
-->
</style>
<script type="text/javascript" language="javascript">
<!--
function UnCryptMailto(s) {
	var n=0;
	var r="";
	for(var i=0;i<s.length;i++) {		
		n=s.charCodeAt(i); 
		if (n>=8364) {n = 128;}
		r += String.fromCharCode(n+(2));	
	}
	return r;
}
function linkTo_UnCryptMailto(s)	{
	location.href=UnCryptMailto(s);
}
// -->
</script>

</head>
<body>
<center>
<table cellpadding="10" cellspacing="0" class="maintable" id="maintable">
<tr>
    <td colspan="2" class="header">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
		<td class="headerleft"/>
		<td class="headercenter"><h1>Sphere Online Judge</h1></td>
		<td class="headerright"/>
	</tr>
	</table>
    </td>
</tr>
<tr><td class="menu" width="92" valign="top">
<form name="login"  action="http://spoj.sphere.pl/problems/DIRVS/" method="post" 
	onsubmit="if(document.login.ssl.checked) document.login.action='https://spoj.sphere.pl/problems/DIRVS/'" style="margin-bottom: 18px"> 
User: <input name="login_user" type="text" style="width: 85px;" class="form"><BR>
Password: <input name="password" type="password" style="width: 85px;" class="form"><BR>
<script language="javascript" type="text/javascript">
<!--
document.write('<input type="checkbox" name="ssl" id="ssl" checked>secure<br>');
//-->
</script>
<input name="submit" type="submit" value="Log In" class="button" style="width: 85px;">
</form><div class="menucmd"><a href="https://spoj.sphere.pl/register">register</a><br><br><a href="https://spoj.sphere.pl/status">status</a><br><a href="https://spoj.sphere.pl/submit">submit</a><br><a href="../classical/sort=0,start=250.html">problems</a><br><br><a href="https://spoj.sphere.pl/">news</a><br><a href="https://spoj.sphere.pl/contests">contests</a><br><a href="https://spoj.sphere.pl/info">info</a><br><a href="https://spoj.sphere.pl/ranks/">ranks</a><br><br><a href="https://spoj.sphere.pl/forum">forum</a><br><a href="https://spoj.sphere.pl/help">help</a><br><a href="https://spoj.sphere.pl/links">links</a><br><hr></div>Server time:<br>2006-01-10<br>05:47:14<a href="../classical/sort=0,start=250.html"></a><br><br>
<form method="get" action="https://spoj.sphere.pl/search/" class="form" style="width:90px">
<input type="text" name="query" style="width:85px" maxlength=255 value="" class="form"><br>
<input type="submit" value="Search" style="width:85px" class="form" title="Search site"><br>
&nbsp;<a href="https://spoj.sphere.pl/search/problems=on,users=on,contests=on" title="More search options"><small>advanced...</small></a>
</form></td><td class="content" width="99%"><table class="problems" width="100%">
<tr class="navigation">
<td><a href="https://spoj.sphere.pl/submit/DIRVS/">Submit</a></td>
<td><a href="https://spoj.sphere.pl/status/DIRVS/">All submissions</a></td>
<td><a href="https://spoj.sphere.pl/ranks/DIRVS/">Best solutions</a></td>
<td><a href="https://spoj.sphere.pl/problems/DIRVS.ps">PS</a></td>
<td><a href="https://spoj.sphere.pl/problems/DIRVS.pdf">PDF</a></td>
<td><a href="../classical/sort=0,start=250.html">Back to list</a></td>
</tr>
</table>

<div class="prob">

<h2>SPOJ Problem Set </h2>
<h1>9. Direct Visibility</h1>
<h2>Problem code: DIRVS</h2>
<p align="justify">
<P>
Building the GSM network is a very expensive and complex task. Moreover,
after the <EM>Base Transceiver Stations</em> (<EM>BTS</em>) are built and
working, we need to perform many various measurements to determine the state
of the network, and propose effective improvements to be made.


<P>
The ACM technicians have a special equipment for measuring the strength of
electro-magnetic fields, the transceivers' power and quality of the signal.
This equipment is packed into a huge knapsack and the technician must move
with it from one BTS to another. Unfortunately, the knapsack have not enough
memory for storing all of the measured values. It has a small cache only,
that can store values for several seconds. Then the values must be
transmitted to the BTS by an infrared connection (IRDA). The IRDA needs
direct visibility between the technician and the BTS.

<P>
Your task is to find the path between two neighbouring BTSes such that at
least one of those BTSes is always visible.

<P>
<H3>Input</h3>

<P>
There is a single positive integer <VAR>T</var> on the first line of input (equal to about 500). It stands
for the number of test cases to follow. Each test case consists of a town
description. For simplicity, a town is modelled as a rectangular grid of

<VAR>P x Q</var> square fields. Each field is exactly 1 metre wide. For each
field, a non-negative integer <VAR>Z</var><SUB><VAR>i</var>,<VAR>j</var></sub> is given, representing the height of
the terrain in that place, in metres. That means the town model is made of
cubes, each of them being either solid or empty. There are no "half solid"
cubes.

<P>
The first line of each test case contains two integer numbers <VAR>P</var> and <VAR>Q</var>,
separated by a single space, 
1 <= <VAR>P</var>,<VAR>Q</var> <= 200. Then there are <VAR>P</var> lines
each containing <VAR>Q</var> integer numbers separated by a space. These numbers are

<VAR>Z</var><SUB><VAR>i</var>,<VAR>j</var></sub>, where 
1 <= <VAR>i</var> <= <VAR>P</var>, 
1 <= <VAR>j</var> <= <VAR>Q</var> and

0 <= <VAR>Z</var><SUB><VAR>i</var>,<VAR>j</var></sub> <= 5000. After the terrain
description, there are four numbers 

<VAR>R</var><SUB>1</sub>, <VAR>C</var><SUB>1</sub>, <VAR>R</var><SUB>2</sub>, <VAR>C</var><SUB>2</sub> on the last line of
each test case. These numbers represent position of two
BTSes, 
1 <= <VAR>R</var><SUB>1</sub>,<VAR>R</var><SUB>2</sub> <= <VAR>P</var>, 
1 <= <VAR>C</var><SUB>1</sub>,<VAR>C</var><SUB>2</sub> <= <VAR>Q</var>. The first coordinate
(<VAR>R</var>) determines the row of the town, the second coordinate determines the
column.


<P>
The technician is moving in steps (<EM>steps</em> stands for
<EM>Standard Technician's Elementary Positional Shift</em>). Each step is made
between two neighbouring square fields. That means the step is always in
North, South, West or East direction. It is not possible to move diagonally.
The step between two fields <VAR>A</var> and <VAR>B</var> (step from <VAR>A</var> to <VAR>B</var>) is allowed
only if the height of the terrain in the field <VAR>B</var> is not very different from
the height in the field <VAR>A</var>. The technician can climb at most 1 metre up or
descend at most 3 metres down in a single step.


<P>
At the end of each step, at least one of the two BTSes must be visible.
However, there can be some point "in the middle of the step" where no BTS
is visible. This is OK and the data is handled by the cache. The BTS is
considered visible, if there is a direct visibility between the unit cube
just above the terrain on the BTSes coordinates and the cube just above the
terrain on the square field, where the technician is. Direct visibility
between two cubes means that the line connecting the centres of the two cubes
does not intersect any solid cube. However, the line can touch any number of
solid cubes. In other words, consider both the BTS and the technician being
points exactly half metre above the surface and in the centre of the
appropriate square field.

<P>
Note that the IRDA beam can go between two cubes that touch each other by
their edge, although there is no space between them. It is because such
a beam touches both of these two cubes but does not intersect any of
them. See the last test case of the sample input for an example of such
a situation.

<P>
<H3>Output</h3>

<P>
You are to find the shortest possible path meeting the above criteria. All
steps must be done between neighbouring fields, the terrain must not elevate
or descend too much, and at the end of each step, at least one BTS must be
visible.

<P>
For each test case, print one line containing the sentence
<TT>The shortest path is </tt><VAR>M</var><TT> steps long.</tt>, where <VAR>M</var> is the number of
steps that must be made. If there is no such path, output the sentence

<TT>Mission impossible!</tt>.

<h3>Example</h3>
<p>Sample Input:</p>

<PRE><tt>4
5 5
8 7 6 5 4
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2
1 1 5 1
5 8
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
9 9 9 9 9 9 9 2
2 2 2 2 2 2 2 2
1 2 5 1
5 8
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
9 9 9 9 9 9 9 2
2 2 2 2 2 2 2 2
1 5 5 1
6 12
5 5 5 5 1 5 5 5 5 5 5 5
5 5 5 5 1 5 5 5 5 5 5 5
5 5 5 5 9 5 5 5 5 5 5 5
5 9 1 5 5 5 5 5 5 5 5 5
5 5 9 5 5 5 5 5 5 5 5 5
5 5 9 5 5 5 5 5 5 5 5 5
6 1 3 12
</tt></pre>

<p>Sample Output:</p>

<PRE>
<tt>The shortest path is 10 steps long.
Mission impossible!
The shortest path is 14 steps long.
The shortest path is 18 steps long.
</tt></pre>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left>
<tr><td width=130>Added by:</td><td><a href="https://spoj.sphere.pl/search/'Adrian%20Kosowski'">Adrian Kosowski</a></td></tr>
<tr><td>Date:</td><td>2004-05-08</td></tr>
<tr><td>Time limit:</td><td>13s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Resource:</td><td>ACM Central European Programming Contest, Prague 2000</td></tr></table>
</div></td>
</tr>

<tr>
<td colspan="2" class="footer">

<script language="javascript" type="text/javascript">
<!--
function swapSheet(sheet, caller) {
    document.getElementById('theme').href=sheet;
    document.cookie="css_0="+sheet+"; path=/;";
    caller.href="#bottom";
}

function setWidth(w, caller) {
    document.getElementById('maintable').style.width=w;
    document.cookie="res="+w+"; path=/;";
    caller.href="#bottom";
}
//-->

</script>
        <table width="100%">
    <tr>
	<td align="left">
            <a href="http://www.pg.gda.pl/eng.html"><IMG src="https://spoj.sphere.pl/gfx/logo-pg" alt="www.pg.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://www.eti.pg.gda.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-eti" alt="www.eti.pg.gda.pl" border=0 height=36 width=44></a>
	</td>
	<td align="center">
	    page size:
	    <a href="https://spoj.sphere.pl/?res=755"  onClick="setWidth('755', this)">800x600</a>
	    <a href="https://spoj.sphere.pl/?res=980"  onClick="setWidth('980', this)">1024x768</a>
	    <a href="https://spoj.sphere.pl/?res=100%" onClick="setWidth('100%', this)">Full</a>
	    &nbsp;&nbsp;
	    theme:
	    <a href="../../indexb6a4.html?css=/themes/skin1.css" onClick="swapSheet('../../themes/skin1.css', this)">olive</a>
	    <a href="../../index3840.html?css=/themes/skin2.css" onClick="swapSheet('../../themes/skin2.css', this)">banana</a>
	    <a href="../../index80f0.html?css=/themes/skin3.css" onClick="swapSheet('../../themes/skin3.css', this)">plum</a>
	    <br>
	    <a href="http://sphere.pl/?id=66">spoj team at sphere</a> &copy; 2004-05 all rights reserved
	</td>
	<td align="right">
            <a href="http://task.gda.pl/english/"><IMG src="https://spoj.sphere.pl/gfx/logo-task" alt="task.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://sphere.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-sphere" alt="sphere.pl" border=0 height=32></a>
	</td>
    </tr>
    </table>
    </tr></table>
</center>
</body>

<!-- Mirrored from spoj.sphere.pl/problems/DIRVS/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:48:45 GMT -->
</html>