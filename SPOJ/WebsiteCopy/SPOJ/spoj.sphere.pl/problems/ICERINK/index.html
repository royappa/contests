<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from spoj.sphere.pl/problems/ICERINK/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:52:44 GMT -->
<head>
<title>Sphere Online Judge (SPOJ)  - Problem ICERINK</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<META NAME="Keywords" CONTENT="spoj, online, judge, problem, set, problemset, archive, ACM, Polish, Poland, contest, contester, task, tasks, ADA, Java, Pascal, C, C++, Whitespace, sphere, interest, group, python, ruby, icon, o'caml, caml, ocaml, perl, haskell, bf, brain, clips, prolog, fortran, asm, assembler, asembler, functional, esoteric, programming, languages">

<link href="https://spoj.sphere.pl/gfx/favicon" rel="shortcut icon" type="image/x-icon">

<link href="../../themes/skin3.css" rel="stylesheet" type="text/css" id="theme">
<style type="text/css">
<!--
.maintable {width: 755;} 
-->
</style>
<script type="text/javascript" language="javascript">
<!--
function UnCryptMailto(s) {
	var n=0;
	var r="";
	for(var i=0;i<s.length;i++) {		
		n=s.charCodeAt(i); 
		if (n>=8364) {n = 128;}
		r += String.fromCharCode(n+(2));	
	}
	return r;
}
function linkTo_UnCryptMailto(s)	{
	location.href=UnCryptMailto(s);
}
// -->
</script>

</head>
<body>
<center>
<table cellpadding="10" cellspacing="0" class="maintable" id="maintable">
<tr>
    <td colspan="2" class="header">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
		<td class="headerleft"/>
		<td class="headercenter"><h1>Sphere Online Judge</h1></td>
		<td class="headerright"/>
	</tr>
	</table>
    </td>
</tr>
<tr><td class="menu" width="92" valign="top">
<form name="login"  action="http://spoj.sphere.pl/problems/ICERINK/" method="post" 
	onsubmit="if(document.login.ssl.checked) document.login.action='https://spoj.sphere.pl/problems/ICERINK/'" style="margin-bottom: 18px"> 
User: <input name="login_user" type="text" style="width: 85px;" class="form"><BR>
Password: <input name="password" type="password" style="width: 85px;" class="form"><BR>
<script language="javascript" type="text/javascript">
<!--
document.write('<input type="checkbox" name="ssl" id="ssl" checked>secure<br>');
//-->
</script>
<input name="submit" type="submit" value="Log In" class="button" style="width: 85px;">
</form><div class="menucmd"><a href="https://spoj.sphere.pl/register">register</a><br><br><a href="https://spoj.sphere.pl/status">status</a><br><a href="https://spoj.sphere.pl/submit">submit</a><br><a href="../classical/sort=5,start=0.html">problems</a><br><br><a href="https://spoj.sphere.pl/">news</a><br><a href="https://spoj.sphere.pl/contests">contests</a><br><a href="https://spoj.sphere.pl/info">info</a><br><a href="https://spoj.sphere.pl/ranks/">ranks</a><br><br><a href="https://spoj.sphere.pl/forum">forum</a><br><a href="https://spoj.sphere.pl/help">help</a><br><a href="https://spoj.sphere.pl/links">links</a><br><hr></div>Server time:<br>2006-01-10<br>05:48:19<a href="../classical/sort=5,start=0.html"></a><br><br>
<form method="get" action="https://spoj.sphere.pl/search/" class="form" style="width:90px">
<input type="text" name="query" style="width:85px" maxlength=255 value="" class="form"><br>
<input type="submit" value="Search" style="width:85px" class="form" title="Search site"><br>
&nbsp;<a href="https://spoj.sphere.pl/search/problems=on,users=on,contests=on" title="More search options"><small>advanced...</small></a>
</form></td><td class="content" width="99%"><table class="problems" width="100%">
<tr class="navigation">
<td><a href="https://spoj.sphere.pl/submit/ICERINK/">Submit</a></td>
<td><a href="https://spoj.sphere.pl/status/ICERINK/">All submissions</a></td>
<td><a href="https://spoj.sphere.pl/ranks/ICERINK/">Best solutions</a></td>
<td><a href="https://spoj.sphere.pl/problems/ICERINK.ps">PS</a></td>
<td><a href="https://spoj.sphere.pl/problems/ICERINK.pdf">PDF</a></td>
<td><a href="../classical/sort=5,start=0.html">Back to list</a></td>
</tr>
</table>

<div class="prob">

<h2>SPOJ Problem Set </h2>
<h1>205. Icerink</h1>
<h2>Problem code: ICERINK</h2>
<p align="justify">
<p>A skating competition was organized on the largest icerink in
Byteland. The
icerink is a square of size 10000 * 10000. A competitor begins skating
at the START point chosen by referees and his task is to finish sliding
at the
FINISH point, also
chosen by referees. The points of START and FINISH are different. One
can slide in directions parallel to the sides of the
icerink. There are some obstacles placed on the icerink. Each obstacle
is a prism, which base is a polygon with sides parallel to the sides of
the
icerink. Each two adjacent sides of the base are always perpendicular.
The obstacles do not have
common points.
Each slide finishes up at the point where a competitor, for the first
time, meets the
wall of an obstacle, which is perpendicular to the direction of the
slide. In other words,
one can stop only when he crashes on a wall or in the FINISH point.
Falling out
of the icerink causes disqualification. Competitor may slide along
walls of
an obstacle.
</p>

<center>
<table width="442">
<tbody><tr><td width="486">
<img src="lodow1.gif"  height="85" width="420">
</td></tr>
<tr><td width="486">
<img src="lodow2.gif"  height="85" width="445">
</td></tr>
</tbody></table>
</center>

<p>
Decide, whether a competitor who slides according to the given rules may reach the finish
point, assuming he begun sliding from the starting point. If so, what is the minimal number
of slides he needs to do?
</p>

<h3>Task</h3> 

<p>
Write a program which:
</p><ul>
 <li>reads the description of the icerink, obstacles, and the coordinates of the
  start and finish point from the standard input,
 </li><li>verifies, whether a competitor who begins from the starting point and
  slides according the rules may reach the finish point, and if so, computes the minimal number
of slides he needs to do,
 </li><li>writes the result in the standard output.
</li></ul>  

<h3>Input</h3> 
<p>
The number of test cases t is in the first line of input, then t test cases follow separated by an empty line.
We define a system of coordinates to describe positions of objects
on a rink.
The rink is a square with vertices
(0,0),(10000,0),(10000,10000),(0,10000). In the first line of each test case 
there are two integers
<i>z<sub>1</sub> </i> and <i> z<sub>2</sub> </i> separated by a single space, 0&lt;=<i>z<sub>1</sub>,
z<sub>2</sub></i>&lt;=10000. The pair (<i>z<sub>1</sub>, z<sub>2</sub></i>) denotes coordinates of the START point. In the second line of the file there are two integers
<i>t<sub>1</sub> </i> and <i> t<sub>2</sub> </i> separated by single space, 0&lt;=<i>t<sub>1</sub>, t<sub>2</sub></i>&lt;=10000. The pair
(<i>t<sub>1</sub>, t<sub>2</sub></i>) denotes coordinates of the FINISH point. The third line of the file
contains one integer <i>s</i>, 1&lt;=<i>s</i>&lt;=2500. This is the number of obstacles. The following lines comprise descriptions
of <i> s </i> obstacles. Each description of an obstacle begins with the line
containing one
positive integer <i>r </i> equal to the number of walls (sides of the base)  of
the obstacle. In each of the following
<i> r</i> lines there are two integers<i> x</i> and <i> y</i>
separated by a single space. These are the coordinates of the vertices of the obstacle's base,
given in a clockwise order. (i.e. when going around the obstacle in this
direction the inside is on the left-hand side). The total number of side walls of
the obstacles does not exceed 10000.</p> 

<h3>Output</h3> 

<p> 

Your program should write for each test case:</p>
<ul>
<li>either one word 'NO' if it's impossible to get from the
  START point to the FINISH point
</li><li>or the minimal number of slides necessary to get to the FINISH point, if it
  is possible.
</li></ul>

<h3>Example</h3> 

<pre>
<b>Sample input:</b>
1
40 10
5 40
3
6
0 15
0 60
20 60
20 55
5 55
5 15
12
30 55
30 60
60 60
60 0
0 0
0 5
55 5
55 35
50 35
50 40
55 40
55 55
6
30 25
15 25
15 30
35 30
35 15
30 15

<b>Sample output:</b>
4
</pre>

<p>The sample input corresponds to the following situation:</p>
<p>
<img src="lodow3.gif"  height="358" width="358">
<p>
These are the possible sequences of slides of length 4:
<p>
<table>
<tbody><tr>
<td><img src="lodow4.gif"  height="152" width="152"></td>
<td><img src="lodow5.gif"  height="152" width="152"></td>
<td><img src="lodow6.gif"  height="152" width="152"></td>
</tr>
</tbody></table>

<b>Warning: large Input/Output data, be careful with certain languages</b>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left>
<tr><td width=130>Added by:</td><td><a href="https://spoj.sphere.pl/search/'Piotr%20£owiec'">Piotr £owiec</a></td></tr>
<tr><td>Date:</td><td>2004-09-13</td></tr>
<tr><td>Time limit:</td><td>7s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Resource:</td><td>6th Polish Olympiad in Informatics, stage 2</td></tr></table>
</div></td>
</tr>

<tr>
<td colspan="2" class="footer">

<script language="javascript" type="text/javascript">
<!--
function swapSheet(sheet, caller) {
    document.getElementById('theme').href=sheet;
    document.cookie="css_0="+sheet+"; path=/;";
    caller.href="#bottom";
}

function setWidth(w, caller) {
    document.getElementById('maintable').style.width=w;
    document.cookie="res="+w+"; path=/;";
    caller.href="#bottom";
}
//-->

</script>
        <table width="100%">
    <tr>
	<td align="left">
            <a href="http://www.pg.gda.pl/eng.html"><IMG src="https://spoj.sphere.pl/gfx/logo-pg" alt="www.pg.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://www.eti.pg.gda.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-eti" alt="www.eti.pg.gda.pl" border=0 height=36 width=44></a>
	</td>
	<td align="center">
	    page size:
	    <a href="https://spoj.sphere.pl/?res=755"  onClick="setWidth('755', this)">800x600</a>
	    <a href="https://spoj.sphere.pl/?res=980"  onClick="setWidth('980', this)">1024x768</a>
	    <a href="https://spoj.sphere.pl/?res=100%" onClick="setWidth('100%', this)">Full</a>
	    &nbsp;&nbsp;
	    theme:
	    <a href="../../indexb6a4.html?css=/themes/skin1.css" onClick="swapSheet('../../themes/skin1.css', this)">olive</a>
	    <a href="../../index3840.html?css=/themes/skin2.css" onClick="swapSheet('../../themes/skin2.css', this)">banana</a>
	    <a href="../../index80f0.html?css=/themes/skin3.css" onClick="swapSheet('../../themes/skin3.css', this)">plum</a>
	    <br>
	    <a href="http://sphere.pl/?id=66">spoj team at sphere</a> &copy; 2004-05 all rights reserved
	</td>
	<td align="right">
            <a href="http://task.gda.pl/english/"><IMG src="https://spoj.sphere.pl/gfx/logo-task" alt="task.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://sphere.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-sphere" alt="sphere.pl" border=0 height=32></a>
	</td>
    </tr>
    </table>
    </tr></table>
</center>
</body>

<!-- Mirrored from spoj.sphere.pl/problems/ICERINK/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 04:52:44 GMT -->
</html>