<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from spoj.sphere.pl/problems/MUSKET/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 05:01:03 GMT -->
<head>
<title>Sphere Online Judge (SPOJ)  - Problem MUSKET</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<META NAME="Keywords" CONTENT="spoj, online, judge, problem, set, problemset, archive, ACM, Polish, Poland, contest, contester, task, tasks, ADA, Java, Pascal, C, C++, Whitespace, sphere, interest, group, python, ruby, icon, o'caml, caml, ocaml, perl, haskell, bf, brain, clips, prolog, fortran, asm, assembler, asembler, functional, esoteric, programming, languages">

<link href="https://spoj.sphere.pl/gfx/favicon" rel="shortcut icon" type="image/x-icon">

<link href="../../themes/skin3.css" rel="stylesheet" type="text/css" id="theme">
<style type="text/css">
<!--
.maintable {width: 755;} 
-->
</style>
<script type="text/javascript" language="javascript">
<!--
function UnCryptMailto(s) {
	var n=0;
	var r="";
	for(var i=0;i<s.length;i++) {		
		n=s.charCodeAt(i); 
		if (n>=8364) {n = 128;}
		r += String.fromCharCode(n+(2));	
	}
	return r;
}
function linkTo_UnCryptMailto(s)	{
	location.href=UnCryptMailto(s);
}
// -->
</script>

</head>
<body>
<center>
<table cellpadding="10" cellspacing="0" class="maintable" id="maintable">
<tr>
    <td colspan="2" class="header">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
		<td class="headerleft"/>
		<td class="headercenter"><h1>Sphere Online Judge</h1></td>
		<td class="headerright"/>
	</tr>
	</table>
    </td>
</tr>
<tr><td class="menu" width="92" valign="top">
<form name="login"  action="http://spoj.sphere.pl/problems/MUSKET/" method="post" 
	onsubmit="if(document.login.ssl.checked) document.login.action='https://spoj.sphere.pl/problems/MUSKET/'" style="margin-bottom: 18px"> 
User: <input name="login_user" type="text" style="width: 85px;" class="form"><BR>
Password: <input name="password" type="password" style="width: 85px;" class="form"><BR>
<script language="javascript" type="text/javascript">
<!--
document.write('<input type="checkbox" name="ssl" id="ssl" checked>secure<br>');
//-->
</script>
<input name="submit" type="submit" value="Log In" class="button" style="width: 85px;">
</form><div class="menucmd"><a href="https://spoj.sphere.pl/register">register</a><br><br><a href="https://spoj.sphere.pl/status">status</a><br><a href="https://spoj.sphere.pl/submit">submit</a><br><a href="../classical/sort=7,start=0.html">problems</a><br><br><a href="https://spoj.sphere.pl/">news</a><br><a href="https://spoj.sphere.pl/contests">contests</a><br><a href="https://spoj.sphere.pl/info">info</a><br><a href="https://spoj.sphere.pl/ranks/">ranks</a><br><br><a href="https://spoj.sphere.pl/forum">forum</a><br><a href="https://spoj.sphere.pl/help">help</a><br><a href="https://spoj.sphere.pl/links">links</a><br><hr></div>Server time:<br>2006-01-10<br>05:52:26<a href="../classical/sort=7,start=0.html"></a><br><br>
<form method="get" action="https://spoj.sphere.pl/search/" class="form" style="width:90px">
<input type="text" name="query" style="width:85px" maxlength=255 value="" class="form"><br>
<input type="submit" value="Search" style="width:85px" class="form" title="Search site"><br>
&nbsp;<a href="https://spoj.sphere.pl/search/problems=on,users=on,contests=on" title="More search options"><small>advanced...</small></a>
</form></td><td class="content" width="99%"><table class="problems" width="100%">
<tr class="navigation">
<td><a href="https://spoj.sphere.pl/submit/MUSKET/">Submit</a></td>
<td><a href="https://spoj.sphere.pl/status/MUSKET/">All submissions</a></td>
<td><a href="https://spoj.sphere.pl/ranks/MUSKET/">Best solutions</a></td>
<td><a href="https://spoj.sphere.pl/problems/MUSKET.ps">PS</a></td>
<td><a href="https://spoj.sphere.pl/problems/MUSKET.pdf">PDF</a></td>
<td><a href="../classical/sort=7,start=0.html">Back to list</a></td>
</tr>
</table>

<div class="prob">

<h2>SPOJ Problem Set </h2>
<h1>196. Musketeers</h1>
<h2>Problem code: MUSKET</h2>
<p align="justify">
<p>
In the time of Louis XIII and his powerful minister cardinal Richelieu in the Full Barrel Inn
<i> n</i> musketeers had consumed their meal and were drinking wine. Wine had not run short and
therefore the musketeers were eager to quarrel, a drunken brawl broke out, in which each musketeer insulted all the
others.
</p>

<p>
A duel was inevitable. But who should fight who and in what order? They
decided (for the first time since the brawl they had done something
together) that they would stay in a circle and draw lots in order. A
drawn musketeer fought against his neighbor to the right. A looser
"quit the game" and to be more precise his corpse was taken away by
servants. The next musketeer who stood beside the looser became the
neighbor of a winner. 
</p>

<p>After years, when historians read memories of the winner they
realized that a final result depended in a crucial extent on the order
of duels. They noticed that a fence practice had indicated, who
against who could win a
duel. It appeared that (in mathematical language) the relation "<b>A</b> wins
<b>B</b>" was not transitive! It could happen that the musketeer <b> A</b> fought better than
<b>B</b>, <b> B</b> better than <b> C</b> and <b> C</b> better than <b>A</b>. Of course, among three of them the first duel influenced the final result. If
<b> A </b> and <b> B</b> fight as the first, <b> C</b> wins eventually. But if <b> B</b> and
<b> C</b> fight as the first, <b> A</b> wins finally. Historians
fascinated by their discovery decided to verify which musketeers could
survive. The fate of France and the whole civilized Europe indeed
depended on that!
</p>

<h3>Task</h3>
<p>
<i>
N</i> persons with consecutive numbers from <i> 1</i> to <i> n</i> stay in a circle. They fight
<i> n-1</i> duels. In the first round one of these persons (e.g. with the number
<i> i</i>) fights against its neighbor to the right, i.e. against the person numbered <i> i+1</i> (or, if
<i>i=n</i>, against the person numbered <i>1</i>).  A looser quits the game, and
the circle is tighten so that the next person in order becomes a winner's neighbor. We are given the
table with possible duels results, in the form of a matrix. If <b>A</b><i>i,j</i> = 1
then the person with the number
<i> i</i> always wins with the person <i>j</i>. If <b>A</b><i>i,j</i> = 0 the person
<i>i</i> looses with <i>j</i>. We can say that the person<i> k</i> may win the game if there exists such a series of
<i>n-1</i> drawings, that <i>k</i>
wins the final duel.<br>
Write a program which:
</p>
<ul>
  <li>reads matrix <b> A</b> from the standard input,
  </li><li>computes numbers of persons, who may win the game,
  </li><li>writes them into the standard output.
</li></ul>

<h3>Input</h3>
<p>
The number of test cases t is in the first line of input, then t test cases follow separated by an empty line.
In the first line of each test case integer <i>n</i> which satisfies the inequality
<i> 3&lt;=n&lt;=100</i> is written. In each of the following <i> n</i> lines appears one word
consisting of
<i> n</i> digits 0 or 1. A digit on <i>j</i>-th position in<i> i</i>-th line denote <b>A</b><i>i,j.</i> Of course <b>A</b><i>i,j </i>= 1 - <b>A</b><i>j,i</i>, for <i> i&lt;&gt;j</i>. We assume that
<b>A</b><i>i,i </i>= 1, for each <i>i</i>. 
</p>

<h3>Output</h3>
<p>
For each test case in the first line there should be written <i> m</i> - the
number of persons, who may
win the game. In the following <i> m</i> lines numbers of these persons should be written in  ascending order, one number in each line.
</p>

<h3>Example</h3>
<pre><b>Sample input:</b>
1
7
1111101
0101100
0111111
0001101
0000101
1101111
0100001

<b>Sample output:</b>
3
1
3
6
</pre>

<p>
The order of duels: 1-2, 1-3, 5-6, 7-1, 4-6, 6-1 gives a final victory to the person numbered 6. You can also check that only two persons more (1 and 3) may win the game.


<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left>
<tr><td width=130>Added by:</td><td><a href="https://spoj.sphere.pl/search/'Piotr%20£owiec'">Piotr £owiec</a></td></tr>
<tr><td>Date:</td><td>2004-09-13</td></tr>
<tr><td>Time limit:</td><td>7s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Resource:</td><td>6th Polish Olympiad in Informatics, stage 1</td></tr></table>
</div></td>
</tr>

<tr>
<td colspan="2" class="footer">

<script language="javascript" type="text/javascript">
<!--
function swapSheet(sheet, caller) {
    document.getElementById('theme').href=sheet;
    document.cookie="css_0="+sheet+"; path=/;";
    caller.href="#bottom";
}

function setWidth(w, caller) {
    document.getElementById('maintable').style.width=w;
    document.cookie="res="+w+"; path=/;";
    caller.href="#bottom";
}
//-->

</script>
        <table width="100%">
    <tr>
	<td align="left">
            <a href="http://www.pg.gda.pl/eng.html"><IMG src="https://spoj.sphere.pl/gfx/logo-pg" alt="www.pg.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://www.eti.pg.gda.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-eti" alt="www.eti.pg.gda.pl" border=0 height=36 width=44></a>
	</td>
	<td align="center">
	    page size:
	    <a href="https://spoj.sphere.pl/?res=755"  onClick="setWidth('755', this)">800x600</a>
	    <a href="https://spoj.sphere.pl/?res=980"  onClick="setWidth('980', this)">1024x768</a>
	    <a href="https://spoj.sphere.pl/?res=100%" onClick="setWidth('100%', this)">Full</a>
	    &nbsp;&nbsp;
	    theme:
	    <a href="../../indexb6a4.html?css=/themes/skin1.css" onClick="swapSheet('../../themes/skin1.css', this)">olive</a>
	    <a href="../../index3840.html?css=/themes/skin2.css" onClick="swapSheet('../../themes/skin2.css', this)">banana</a>
	    <a href="../../index80f0.html?css=/themes/skin3.css" onClick="swapSheet('../../themes/skin3.css', this)">plum</a>
	    <br>
	    <a href="http://sphere.pl/?id=66">spoj team at sphere</a> &copy; 2004-05 all rights reserved
	</td>
	<td align="right">
            <a href="http://task.gda.pl/english/"><IMG src="https://spoj.sphere.pl/gfx/logo-task" alt="task.gda.pl" border=0 height=36 width=44></a>&nbsp;
            <a href="http://sphere.pl/"><IMG src="https://spoj.sphere.pl/gfx/logo-sphere" alt="sphere.pl" border=0 height=32></a>
	</td>
    </tr>
    </table>
    </tr></table>
</center>
</body>

<!-- Mirrored from spoj.sphere.pl/problems/MUSKET/ by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 10 Jan 2006 05:01:03 GMT -->
</html>